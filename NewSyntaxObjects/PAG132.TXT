OBJECT Page 132 Posted Sales Invoice
{
  OBJECT-PROPERTIES
  {
    Date=20180425D;
    Time=161208.450T;
    Modified=true;
    Version List=;
  }
  PROPERTIES
  {
    CaptionML=ENU=Posted Sales Invoice;
    InsertAllowed=false;
    SourceTable="Sales Invoice Header";
    PageType=Document;
    RefreshOnActivate=true;
    PromotedActionCategoriesML=ENU=New,Process,Report,Invoice,Correct;
    OnInit=BEGIN
             DocExcStatusVisible := true;
           END;

    OnOpenPage=VAR
                 OfficeMgt@1001 : Codeunit "Office Management";
               BEGIN
                 SetSecurityFilterOnRespCenter;
                 CRMIntegrationEnabled := CRMIntegrationManagement.IsCRMIntegrationEnabled;

                 IsOfficeAddin := OfficeMgt.IsAvailable;
                 IsFoundationEnabled := ApplicationAreaMgmtFacade.IsFoundationEnabled;
               END;

    OnAfterGetRecord=BEGIN
                       DocExchStatusStyle := GetDocExchStatusStyle;
                     END;

    OnAfterGetCurrRecord=VAR
                           IncomingDocument@1000 : Record "Incoming Document";
                           CRMCouplingManagement@1001 : Codeunit "CRM Coupling Management";
                         BEGIN
                           HasIncomingDocument := IncomingDocument.PostedDocExists("No.","Posting Date");
                           DocExchStatusStyle := GetDocExchStatusStyle;
                           CurrPage.IncomingDocAttachFactBox.PAGE.LoadDataFromRecord(Rec);
                           if CRMIntegrationEnabled then begin
                             CRMIsCoupledToRecord := CRMCouplingManagement.IsRecordCoupledToCRM(RECORDID);
                             if "No." <> xRec."No." then
                               CRMIntegrationManagement.SendResultNotification(Rec);
                           end;
                           UpdatePaymentService;
                           DocExcStatusVisible := DocExchangeStatusIsSent;
                         END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      Name=ActionContainer1900000003;
                      ActionContainerType=RelatedInformation }
      { 55      ;1   ;ActionGroup;
                      Name="&Invoice";
                      CaptionML=ENU=&Invoice;
                      Image=Invoice }
      { 8       ;2   ;Action    ;
                      Name=Statistics;
                      ShortCutKey=F7;
                      CaptionML=ENU=Statistics;
                      ToolTipML=ENU=View statistical information, such as the value of posted entries, for the record.;
                      ApplicationArea=#Basic,#Suite;
                      Promoted=true;
                      PromotedIsBig=true;
                      Image=Statistics;
                      PromotedCategory=Category4;
                      OnAction=BEGIN
                                 OnBeforeCalculateSalesTaxStatistics(Rec);
                                 if "Tax Area Code" = '' then
                                   PAGE.RUNMODAL(PAGE::"Sales Invoice Statistics",Rec,"No.")
                                 else
                                   PAGE.RUNMODAL(PAGE::"Sales Invoice Stats.",Rec,"No.");
                               END;
                                }
      { 57      ;2   ;Action    ;
                      Name="Co&mments";
                      CaptionML=ENU=Co&mments;
                      ToolTipML=ENU=View or add comments for the record.;
                      RunObject=Page "Sales Comment Sheet";
                      RunPageLink="Document Type"=CONST("Posted Invoice"),
                                  "No."=FIELD("No."),
                                  "Document Line No."=CONST(0);
                      Promoted=true;
                      PromotedIsBig=true;
                      Image=ViewComments;
                      PromotedCategory=Category4 }
      { 89      ;2   ;Action    ;
                      Name=Dimensions;
                      AccessByPermission=TableData Dimension=R;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=ENU=Dimensions;
                      ToolTipML=ENU=View or edit dimensions, such as area, project, or department, that you can assign to sales and purchase documents to distribute costs and analyze transaction history.;
                      ApplicationArea=#Dimensions;
                      Promoted=true;
                      PromotedIsBig=true;
                      Image=Dimensions;
                      PromotedCategory=Category4;
                      PromotedOnly=true;
                      OnAction=BEGIN
                                 ShowDimensions;
                               END;
                                }
      { 112     ;2   ;Action    ;
                      Name=Approvals;
                      AccessByPermission=TableData "Posted Approval Entry"=R;
                      CaptionML=ENU=Approvals;
                      ToolTipML=ENU=View a list of the records that are waiting to be approved. For example, you can see who requested the record to be approved, when it was sent, and when it is due to be approved.;
                      ApplicationArea=#Suite;
                      Promoted=true;
                      PromotedIsBig=true;
                      Image=Approvals;
                      PromotedCategory=Category4;
                      PromotedOnly=true;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit "Approvals Mgmt.";
                               BEGIN
                                 ApprovalsMgmt.ShowPostedApprovalEntries(RECORDID);
                               END;
                                }
      { 1901458458;2 ;Action    ;
                      Name=DocAttach;
                      CaptionML=ENU=Attachments;
                      ToolTipML=ENU=Add a file as an attachment. You can attach images as well as documents.;
                      ApplicationArea=#All;
                      Promoted=true;
                      PromotedIsBig=true;
                      Image=Attach;
                      PromotedCategory=Category4;
                      PromotedOnly=true;
                      OnAction=VAR
                                 DocumentAttachmentDetails@1000 : Page "Document Attachment Details";
                                 RecRef@1001 : RecordRef;
                               BEGIN
                                 RecRef.GETTABLE(Rec);
                                 DocumentAttachmentDetails.OpenForRecRef(RecRef);
                                 DocumentAttachmentDetails.RUNMODAL;
                               END;
                                }
      { 171     ;2   ;Separator ;
                      Name=Separator171 }
      { 35      ;2   ;Action    ;
                      Name=ChangePaymentService;
                      CaptionML=ENU=Change Payment Service;
                      ToolTipML=ENU=Change or add the payment service, such as PayPal Standard, that will be included on the sales document so the customer can quickly access the payment site.;
                      ApplicationArea=#Basic,#Suite;
                      Promoted=true;
                      Visible=PaymentServiceVisible;
                      PromotedIsBig=true;
                      Image=ElectronicPayment;
                      PromotedCategory=Category4;
                      PromotedOnly=true;
                      OnAction=VAR
                                 PaymentServiceSetup@1000 : Record "Payment Service Setup";
                               BEGIN
                                 PaymentServiceSetup.ChangePaymentServicePostedInvoice(Rec);
                               END;
                                }
      { 45      ;1   ;ActionGroup;
                      Name=ActionGroupCRM;
                      CaptionML=ENU=Dynamics 365 for Sales;
                      Visible=CRMIntegrationEnabled }
      { 43      ;2   ;Action    ;
                      Name=CRMGotoInvoice;
                      CaptionML=ENU=Invoice;
                      ToolTipML=ENU=Open the coupled Dynamics 365 for Sales invoice.;
                      ApplicationArea=#Suite;
                      Enabled=CRMIsCoupledToRecord;
                      Image=CoupledSalesInvoice;
                      OnAction=VAR
                                 CRMIntegrationManagement@1000 : Codeunit "CRM Integration Management";
                               BEGIN
                                 CRMIntegrationManagement.ShowCRMEntityFromRecordID(RECORDID);
                               END;
                                }
      { 29      ;2   ;Action    ;
                      Name=CreateInCRM;
                      CaptionML=ENU=Create Invoice in Dynamics 365 for Sales;
                      ToolTipML=ENU=Create a sales invoice in Dynamics 365 for Sales that is connected to this posted sales invoice.;
                      ApplicationArea=#Suite;
                      Enabled=NOT CRMIsCoupledToRecord;
                      Image=NewSalesInvoice;
                      OnAction=VAR
                                 CRMIntegrationManagement@1000 : Codeunit "CRM Integration Management";
                               BEGIN
                                 CRMIntegrationManagement.CreateNewRecordsInCRM(RECORDID);
                               END;
                                }
      { 84      ;2   ;Action    ;
                      Name=ShowLog;
                      CaptionML=ENU=Synchronization Log;
                      ToolTipML=ENU=View integration synchronization jobs for the posted sales invoice table.;
                      ApplicationArea=#Suite;
                      Image=Log;
                      OnAction=VAR
                                 CRMIntegrationManagement@1000 : Codeunit "CRM Integration Management";
                               BEGIN
                                 CRMIntegrationManagement.ShowLog(RECORDID);
                               END;
                                }
      { 1900000004;0 ;ActionContainer;
                      Name=ActionContainer1900000004;
                      ActionContainerType=ActionItems }
      { 1020015 ;1   ;ActionGroup;
                      Name="&Electronic Document";
                      CaptionML=ENU=&Electronic Document }
      { 1020039 ;2   ;Action    ;
                      Name="S&end";
                      Ellipsis=true;
                      CaptionML=ENU=S&end;
                      ToolTipML=ENU=Send an email to the customer with the electronic invoice attached as an XML file.;
                      Image=SendTo;
                      OnAction=BEGIN
                                 RequestStampEDocument;
                               END;
                                }
      { 1020016 ;2   ;Action    ;
                      Name="Export E-Document as &XML";
                      CaptionML=ENU=Export E-Document as &XML;
                      ToolTipML=ENU=Export the posted sales invoice as an electronic invoice, and XML file, and save it to a specified location.;
                      Image=ExportElectronicDocument;
                      OnAction=BEGIN
                                 ExportEDocument;
                               END;
                                }
      { 1020003 ;2   ;Action    ;
                      Name="CFDI Information";
                      CaptionML=ENU=CFDI Information;
                      ToolTipML=ENU=View the CFDI information for reversed advance payments.;
                      ApplicationArea=#Basic,#Suite;
                      OnAction=VAR
                                 CFDIDocuments@1020000 : Record "CFDI Documents";
                               BEGIN
                                 if CFDIDocuments.GET("No.",DATABASE::"Sales Invoice Header",true,true) then
                                   PAGE.RUN(PAGE::"SAT CFDI Document Information",CFDIDocuments);
                               END;
                                }
      { 1020040 ;2   ;Action    ;
                      Name="&Cancel";
                      CaptionML=ENU=&Cancel;
                      ToolTipML=ENU=Cancel the sending of the electronic sales invoice.;
                      Image=Cancel;
                      OnAction=BEGIN
                                 CancelEDocument;
                               END;
                                }
      { 5       ;1   ;Action    ;
                      Name=SendCustom;
                      Ellipsis=true;
                      CaptionML=ENU=Send;
                      ToolTipML=ENU=Prepare to send the document according to the customer's sending profile, such as attached to an email. The Send document to window opens first so you can confirm or select a sending profile.;
                      ApplicationArea=#Basic,#Suite;
                      Promoted=true;
                      PromotedIsBig=true;
                      Image=SendToMultiple;
                      PromotedCategory=Category4;
                      PromotedOnly=true;
                      OnAction=VAR
                                 SalesInvHeader@1000 : Record "Sales Invoice Header";
                               BEGIN
                                 SalesInvHeader := Rec;
                                 CurrPage.SETSELECTIONFILTER(SalesInvHeader);
                                 SalesInvHeader.SendRecords;
                               END;
                                }
      { 58      ;1   ;Action    ;
                      Name=Print;
                      Ellipsis=true;
                      CaptionML=ENU=&Print;
                      ToolTipML=ENU=Prepare to print the document. A report request window for the document opens where you can specify what to include on the print-out.;
                      ApplicationArea=#Basic,#Suite;
                      Visible=NOT IsOfficeAddin;
                      Image=Print;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 SalesInvHeader := Rec;
                                 CurrPage.SETSELECTIONFILTER(SalesInvHeader);
                                 SalesInvHeader.PrintRecords(true);
                               END;
                                }
      { 9       ;1   ;Action    ;
                      Name=Email;
                      CaptionML=ENU=&Email;
                      ToolTipML=ENU=Prepare to email the document. The Send Email window opens prefilled with the customer's email address so you can add or edit information.;
                      ApplicationArea=#Basic,#Suite;
                      Image=Email;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 SalesInvHeader := Rec;
                                 CurrPage.SETSELECTIONFILTER(SalesInvHeader);
                                 SalesInvHeader.EmailRecords(true);
                               END;
                                }
      { 59      ;1   ;Action    ;
                      Name="&Navigate";
                      CaptionML=ENU=&Navigate;
                      ToolTipML=ENU=Find all entries and documents that exist for the document number and posting date on the selected entry or document.;
                      ApplicationArea=#Basic,#Suite;
                      Visible=NOT IsOfficeAddin;
                      Image=Navigate;
                      PromotedCategory=Category4;
                      OnAction=BEGIN
                                 Navigate;
                               END;
                                }
      { 13      ;1   ;Action    ;
                      Name=ActivityLog;
                      CaptionML=ENU=Activity Log;
                      ToolTipML=ENU=View the status and any errors if the document was sent as an electronic document or OCR file through the document exchange service.;
                      ApplicationArea=#Basic,#Suite;
                      Image=Log;
                      OnAction=BEGIN
                                 ShowActivityLog;
                               END;
                                }
      { 23      ;1   ;ActionGroup;
                      Name=IncomingDocument;
                      CaptionML=ENU=Incoming Document;
                      ActionContainerType=NewDocumentItems;
                      Image=Documents }
      { 21      ;2   ;Action    ;
                      Name=IncomingDocCard;
                      CaptionML=ENU=View Incoming Document;
                      ToolTipML=ENU=View any incoming document records and file attachments that exist for the entry or document.;
                      ApplicationArea=#Basic,#Suite;
                      Enabled=HasIncomingDocument;
                      Image=ViewOrder;
                      OnAction=VAR
                                 IncomingDocument@1000 : Record "Incoming Document";
                               BEGIN
                                 IncomingDocument.ShowCard("No.","Posting Date");
                               END;
                                }
      { 19      ;2   ;Action    ;
                      Name=SelectIncomingDoc;
                      AccessByPermission=TableData "Incoming Document"=R;
                      CaptionML=ENU=Select Incoming Document;
                      ToolTipML=ENU=Select an incoming document record and file attachment that you want to link to the entry or document.;
                      ApplicationArea=#Basic,#Suite;
                      Enabled=NOT HasIncomingDocument;
                      Image=SelectLineToApply;
                      OnAction=VAR
                                 IncomingDocument@1000 : Record "Incoming Document";
                               BEGIN
                                 IncomingDocument.SelectIncomingDocumentForPostedDocument("No.","Posting Date",RECORDID);
                               END;
                                }
      { 17      ;2   ;Action    ;
                      Name=IncomingDocAttachFile;
                      Ellipsis=true;
                      CaptionML=ENU=Create Incoming Document from File;
                      ToolTipML=ENU=Create an incoming document record by selecting a file to attach, and then link the incoming document record to the entry or document.;
                      ApplicationArea=#Basic,#Suite;
                      Enabled=NOT HasIncomingDocument;
                      Image=Attach;
                      OnAction=VAR
                                 IncomingDocumentAttachment@1000 : Record "Incoming Document Attachment";
                               BEGIN
                                 IncomingDocumentAttachment.NewAttachmentFromPostedDocument("No.","Posting Date");
                               END;
                                }
      { 41      ;1   ;ActionGroup;
                      Name=Correct;
                      CaptionML=ENU=Correct }
      { 39      ;2   ;Action    ;
                      Name=CorrectInvoice;
                      CaptionML=ENU=Correct;
                      ToolTipML=ENU=Reverse this posted invoice and automatically create a new invoice with the same information that you can correct before posting. This posted invoice will automatically be canceled.;
                      ApplicationArea=#Basic,#Suite;
                      Promoted=true;
                      Visible=IsFoundationEnabled;
                      PromotedIsBig=true;
                      Image=Undo;
                      PromotedCategory=Category5;
                      PromotedOnly=true;
                      OnAction=VAR
                                 CorrectPstdSalesInvYesNo@1000 : Codeunit "Correct PstdSalesInv (Yes/No)";
                               BEGIN
                                 if CorrectPstdSalesInvYesNo.CorrectInvoice(Rec) then
                                   CurrPage.CLOSE;
                               END;
                                }
      { 37      ;2   ;Action    ;
                      Name=CancelInvoice;
                      CaptionML=ENU=Cancel;
                      ToolTipML=ENU=Create and post a sales credit memo that reverses this posted sales invoice. This posted sales invoice will be canceled.;
                      ApplicationArea=#Basic,#Suite;
                      Promoted=true;
                      Visible=IsFoundationEnabled;
                      PromotedIsBig=true;
                      Image=Cancel;
                      PromotedCategory=Category5;
                      PromotedOnly=true;
                      OnAction=VAR
                                 CancelPstdSalesInvYesNo@1000 : Codeunit "Cancel PstdSalesInv (Yes/No)";
                               BEGIN
                                 if CancelPstdSalesInvYesNo.CancelInvoice(Rec) then
                                   CurrPage.CLOSE;
                               END;
                                }
      { 33      ;2   ;Action    ;
                      Name=CreateCreditMemo;
                      CaptionML=ENU=Create Corrective Credit Memo;
                      ToolTipML=ENU=Create a credit memo for this posted invoice that you complete and post manually to reverse the posted invoice.;
                      ApplicationArea=#Basic,#Suite;
                      Image=CreateCreditMemo;
                      PromotedCategory=Category5;
                      OnAction=VAR
                                 SalesHeader@1001 : Record "Sales Header";
                                 CorrectPostedSalesInvoice@1000 : Codeunit "Correct Posted Sales Invoice";
                               BEGIN
                                 CorrectPostedSalesInvoice.CreateCreditMemoCopyDocument(Rec,SalesHeader);
                                 PAGE.RUN(PAGE::"Sales Credit Memo",SalesHeader);
                                 CurrPage.CLOSE;
                               END;
                                }
      { 51      ;1   ;ActionGroup;
                      Name=Invoice;
                      CaptionML=ENU=Invoice;
                      Image=Invoice }
      { 49      ;2   ;Action    ;
                      Name=Customer;
                      ShortCutKey=Shift+F7;
                      CaptionML=ENU=Customer;
                      ToolTipML=ENU=View or edit detailed information about the customer.;
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page "Customer Card";
                      RunPageLink="No."=FIELD("Sell-to Customer No.");
                      Promoted=true;
                      PromotedIsBig=true;
                      Image=Customer;
                      PromotedCategory=Category4;
                      PromotedOnly=true }
      { 47      ;2   ;Action    ;
                      Name=ShowCreditMemo;
                      CaptionML=ENU=Show Canceled/Corrective Credit Memo;
                      ToolTipML=ENU=Open the posted sales credit memo that was created when you canceled the posted sales invoice. If the posted sales invoice is the result of a canceled sales credit memo, then canceled sales credit memo will open.;
                      ApplicationArea=#Basic,#Suite;
                      Enabled=Cancelled OR Corrective;
                      Image=CreditMemo;
                      PromotedCategory=Category4;
                      OnAction=BEGIN
                                 ShowCanceledOrCorrCrMemo;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                Name=Control1900000001;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                Name=General;
                CaptionML=ENU=General }

    { 2   ;2   ;Field     ;
                Name="No.";
                ToolTipML=ENU=Specifies the posted invoice number.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="No.";
                Importance=Promoted;
                Editable=FALSE;
                ImplicitType=Code20 }

    { 61  ;2   ;Field     ;
                Name="Sell-to Customer Name";
                CaptionML=ENU=Customer;
                ToolTipML=ENU=Specifies the name of the customer that you shipped the items on the invoice to.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Sell-to Customer Name";
                TableRelation=Customer.Name;
                Importance=Promoted;
                Editable=FALSE;
                ImplicitType=Text50 }

    { 4   ;2   ;Group     ;
                Name="Sell-to";
                CaptionML=ENU=Sell-to;
                GroupType=Group }

    { 63  ;3   ;Field     ;
                Name="Sell-to Address";
                CaptionML=ENU=Address;
                ToolTipML=ENU=Specifies the address of the customer that the items on the invoice were shipped to.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Sell-to Address";
                Importance=Additional;
                Editable=FALSE;
                ImplicitType=Text50 }

    { 65  ;3   ;Field     ;
                Name="Sell-to Address 2";
                CaptionML=ENU=Address 2;
                ToolTipML=ENU=Specifies additional address information.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Sell-to Address 2";
                Importance=Additional;
                Editable=FALSE;
                ImplicitType=Text50 }

    { 67  ;3   ;Field     ;
                Name="Sell-to City";
                CaptionML=ENU=City;
                ToolTipML=ENU=Specifies the city of the customer on the sales document.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Sell-to City";
                Importance=Additional;
                Editable=FALSE;
                ImplicitType=Text30 }

    { 1020005;3;Field     ;
                Name="Sell-to County";
                CaptionML=ENU=State;
                ToolTipML=ENU=Specifies the state as a part of the address.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Sell-to County";
                Importance=Additional;
                Editable=FALSE;
                ImplicitType=Text30 }

    { 6   ;3   ;Field     ;
                Name="Sell-to Post Code";
                CaptionML=ENU=ZIP Code;
                ToolTipML=ENU=Specifies the ZIP code.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Sell-to Post Code";
                Importance=Additional;
                Editable=FALSE;
                ImplicitType=Code20 }

    { 96  ;3   ;Field     ;
                Name="Sell-to Contact No.";
                CaptionML=ENU=Contact No.;
                ToolTipML=ENU=Specifies the number of the contact that the invoice was sent to.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Sell-to Contact No.";
                Importance=Additional;
                Editable=FALSE;
                ImplicitType=Code20 }

    { 69  ;2   ;Field     ;
                Name="Sell-to Contact";
                CaptionML=ENU=Contact;
                ToolTipML=ENU=Specifies the name of the person to contact when you communicate with the customer who you shipped the items to.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Sell-to Contact";
                Editable=FALSE;
                ImplicitType=Text50 }

    { 25  ;2   ;Field     ;
                Name="Document Date";
                ToolTipML=ENU=Specifies the date on which you created the sales document.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Document Date";
                Importance=Additional;
                Editable=FALSE;
                ImplicitType=Date }

    { 12  ;2   ;Field     ;
                Name="Posting Date";
                ToolTipML=ENU=Specifies the date on which the invoice was posted.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Posting Date";
                Editable=FALSE;
                ImplicitType=Date }

    { 68  ;2   ;Field     ;
                Name="Due Date";
                ToolTipML=ENU=Specifies the date on which the invoice is due for payment.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Due Date";
                Importance=Promoted;
                Editable=FALSE;
                ImplicitType=Date }

    { 3   ;2   ;Group     ;
                Name=Control3;
                Visible=DocExcStatusVisible;
                GroupType=Group }

    { 27  ;3   ;Field     ;
                Name="Document Exchange Status";
                ToolTipML=ENU=Specifies the status of the document if you are using a document exchange service to send it as an electronic document. The status values are reported by the document exchange service.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Document Exchange Status";
                Importance=Additional;
                Editable=FALSE;
                StyleExpr=DocExchStatusStyle;
                OnDrillDown=VAR
                              DocExchServDocStatus@1000 : Codeunit "Doc. Exch. Serv.- Doc. Status";
                            BEGIN
                              DocExchServDocStatus.DocExchStatusDrillDown(Rec);
                            END;

                ImplicitType=Option }

    { 114 ;2   ;Field     ;
                Name="Quote No.";
                ToolTipML=ENU=Specifies the number of the sales quote document if a quote was used to start the sales process.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Quote No.";
                ImplicitType=Code20 }

    { 86  ;2   ;Field     ;
                Name="Order No.";
                ToolTipML=ENU=Specifies the number of the sales order that this invoice was posted from.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Order No.";
                Importance=Promoted;
                Editable=FALSE;
                ImplicitType=Code20 }

    { 73  ;2   ;Field     ;
                Name="Pre-Assigned No.";
                ToolTipML=ENU=Specifies the number of the sales document that the posted invoice was created for.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pre-Assigned No.";
                Importance=Additional;
                Editable=FALSE;
                ImplicitType=Code20 }

    { 94  ;2   ;Field     ;
                Name="External Document No.";
                ToolTipML=ENU=Specifies the external document number that is entered on the sales header that this line was posted from.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="External Document No.";
                Importance=Additional;
                Editable=FALSE;
                ImplicitType=Code35 }

    { 10  ;2   ;Field     ;
                Name="Salesperson Code";
                ToolTipML=ENU=Specifies which salesperson is associated with the invoice.;
                ApplicationArea=#Suite;
                SourceExpr="Salesperson Code";
                Importance=Additional;
                Editable=FALSE;
                ImplicitType=Code20 }

    { 92  ;2   ;Field     ;
                Name="Responsibility Center";
                AccessByPermission=TableData "Responsibility Center"=R;
                ToolTipML=ENU=Specifies the code of the responsibility center associated with the user who created the invoice, your company, or the customer in the sales invoice.;
                ApplicationArea=#Advanced;
                SourceExpr="Responsibility Center";
                Importance=Additional;
                Editable=FALSE;
                ImplicitType=Code10 }

    { 14  ;2   ;Field     ;
                Name="No. Printed";
                ToolTipML=ENU=Specifies how many times the document has been printed.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="No. Printed";
                Importance=Additional;
                Editable=FALSE;
                ImplicitType=Integer }

    { 77  ;2   ;Field     ;
                Name=Cancelled;
                ToolTipML=ENU=Specifies if the posted sales invoice has been either corrected or canceled.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Cancelled;
                Importance=Additional;
                Visible=IsFoundationEnabled;
                Style=Unfavorable;
                StyleExpr=Cancelled;
                OnDrillDown=BEGIN
                              ShowCorrectiveCreditMemo;
                            END;

                ImplicitType=Boolean }

    { 102 ;2   ;Field     ;
                Name=Corrective;
                ToolTipML=ENU=Specifies if the posted sales invoice is a corrective document.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Corrective;
                Importance=Additional;
                Style=Unfavorable;
                StyleExpr=Corrective;
                OnDrillDown=BEGIN
                              ShowCancelledCreditMemo;
                            END;

                ImplicitType=Boolean }

    { 76  ;2   ;Field     ;
                Name=Closed;
                ToolTipML=ENU=Specifies if the posted invoice is paid. The check box will also be selected if a credit memo for the remaining amount has been applied.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Closed;
                Importance=Promoted;
                ImplicitType=Boolean }

    { 83  ;2   ;Group     ;
                Name="Work Description";
                CaptionML=ENU=Work Description;
                GroupType=Group }

    { 82  ;3   ;Field     ;
                Name=GetWorkDescription;
                ApplicationArea=#Advanced;
                SourceExpr=GetWorkDescription;
                Importance=Additional;
                Editable=FALSE;
                MultiLine=true;
                ImplicitType=Text;
                ShowCaption=false }

    { 54  ;1   ;Part      ;
                Name=SalesInvLines;
                ApplicationArea=#Basic,#Suite;
                SubPageLink="Document No."=FIELD("No.");
                PagePartID="Posted Sales Invoice Subform" }

    { 16  ;1   ;Group     ;
                Name="Invoice Details";
                CaptionML=ENU=Invoice Details;
                GroupType=Group }

    { 30  ;2   ;Field     ;
                Name="Currency Code";
                ToolTipML=ENU=Specifies the currency code of the invoice.;
                ApplicationArea=#Suite;
                SourceExpr="Currency Code";
                Importance=Promoted;
                Editable=FALSE;
                OnAssistEdit=VAR
                               UpdateCurrencyFactor@1000 : Codeunit "Update Currency Factor";
                             BEGIN
                               ChangeExchangeRate.SetParameter("Currency Code","Currency Factor","Posting Date");
                               ChangeExchangeRate.EDITABLE(false);
                               if ChangeExchangeRate.RUNMODAL = ACTION::OK then begin
                                 "Currency Factor" := ChangeExchangeRate.GetParameter;
                                 UpdateCurrencyFactor.ModifyPostedSalesInvoice(Rec);
                               end;
                               CLEAR(ChangeExchangeRate);
                             END;

                ImplicitType=Code10 }

    { 62  ;2   ;Field     ;
                Name="Shipment Date";
                ToolTipML=ENU=Specifies when items on the document are shipped or were shipped. A shipment date is usually calculated from a requested delivery date plus lead time.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Shipment Date";
                Importance=Promoted;
                Editable=FALSE;
                ImplicitType=Date }

    { 50  ;2   ;Field     ;
                Name="Payment Terms Code";
                ToolTipML=ENU=Specifies a formula that calculates the payment due date, payment discount date, and payment discount amount on the sales document.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Payment Terms Code";
                Importance=Promoted;
                Editable=FALSE;
                ImplicitType=Code10 }

    { 28  ;2   ;Field     ;
                Name="Payment Method Code";
                ToolTipML=ENU=Specifies how the customer must pay for products on the sales document.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Payment Method Code";
                Importance=Additional;
                Editable=FALSE;
                ImplicitType=Code10 }

    { 15  ;2   ;Group     ;
                Name=Control15;
                Visible=PaymentServiceVisible;
                GroupType=Group }

    { 64  ;3   ;Field     ;
                Name=SelectedPayments;
                CaptionML=ENU=Payment Service;
                ToolTipML=ENU=Specifies the payment service, such as PayPal, that the sales invoice can be paid with.;
                ApplicationArea=#All;
                SourceExpr=GetSelectedPaymentsText;
                Enabled=PaymentServiceEnabled;
                Editable=FALSE;
                MultiLine=true;
                OnAssistEdit=VAR
                               PaymentServiceSetup@1000 : Record "Payment Service Setup";
                             BEGIN
                               PaymentServiceSetup.ChangePaymentServicePostedInvoice(Rec);
                               CurrPage.UPDATE(false);
                             END;

                ImplicitType=Text }

    { 66  ;2   ;Field     ;
                Name="Shortcut Dimension 1 Code";
                ToolTipML=ENU=Specifies the code for Shortcut Dimension 1, which is one of two global dimension codes that you set up in the General Ledger Setup window.;
                ApplicationArea=#Dimensions;
                SourceExpr="Shortcut Dimension 1 Code";
                Editable=FALSE;
                ImplicitType=Code20 }

    { 32  ;2   ;Field     ;
                Name="Shortcut Dimension 2 Code";
                ToolTipML=ENU=Specifies the code for Shortcut Dimension 2, which is one of two global dimension codes that you set up in the General Ledger Setup window.;
                ApplicationArea=#Dimensions;
                SourceExpr="Shortcut Dimension 2 Code";
                Editable=FALSE;
                ImplicitType=Code20 }

    { 34  ;2   ;Field     ;
                Name="Payment Discount %";
                ToolTipML=ENU=Specifies the payment discount percent granted if payment is made on or before the date in the Pmt. Discount Date field.;
                ApplicationArea=#Advanced;
                SourceExpr="Payment Discount %";
                Editable=FALSE;
                ImplicitType=Decimal }

    { 7   ;2   ;Field     ;
                Name="Pmt. Discount Date";
                ToolTipML=ENU=Specifies the date on which the amount in the entry must be paid for a payment discount to be granted.;
                ApplicationArea=#Advanced;
                SourceExpr="Pmt. Discount Date";
                Importance=Additional;
                Editable=FALSE;
                ImplicitType=Date }

    { 70  ;2   ;Field     ;
                Name="Direct Debit Mandate ID";
                ToolTipML=ENU=Specifies the direct-debit mandate that the customer has signed to allow direct debit collection of payments.;
                ApplicationArea=#Advanced;
                SourceExpr="Direct Debit Mandate ID";
                Editable=FALSE;
                ImplicitType=Code35 }

    { 1020000;2;Field     ;
                Name="Tax Liable";
                ToolTipML=ENU=Specifies if the customer or vendor is liable for sales tax.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Tax Liable";
                Editable=FALSE;
                ImplicitType=Boolean }

    { 1020002;2;Field     ;
                Name="Tax Area Code";
                ToolTipML=ENU=Specifies the tax area that is used to calculate and post sales tax.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Tax Area Code";
                Editable=FALSE;
                ImplicitType=Code20 }

    { 48  ;2   ;Field     ;
                Name="Location Code";
                ToolTipML=ENU=Specifies the code for the location from which the items were shipped.;
                ApplicationArea=#Location;
                SourceExpr="Location Code";
                Importance=Additional;
                Editable=FALSE;
                ImplicitType=Code10 }

    { 53  ;1   ;Group     ;
                Name="Shipping and Billing";
                CaptionML=ENU=Shipping and Billing;
                GroupType=Group }

    { 80  ;2   ;Group     ;
                Name="Shipping Details";
                CaptionML=ENU=Shipping Details;
                GroupType=Group }

    { 71  ;3   ;Field     ;
                Name="Shipment Method Code";
                CaptionML=ENU=Method;
                ToolTipML=ENU=Specifies the code that represents the shipment method for the invoice.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Shipment Method Code";
                Importance=Additional;
                Editable=FALSE;
                ImplicitType=Code10 }

    { 79  ;3   ;Field     ;
                Name="Shipping Agent Code";
                CaptionML=ENU=Agent;
                ToolTipML=ENU=Specifies which shipping agent is used to transport the items on the sales document to the customer.;
                ApplicationArea=#Suite;
                SourceExpr="Shipping Agent Code";
                Importance=Additional;
                Editable=FALSE;
                ImplicitType=Code10 }

    { 1905198401;2;Group  ;
                Name="Electronic Invoice";
                CaptionML=ENU=Electronic Invoice }

    { 1020023;3;Field     ;
                Name="Electronic Document Status";
                ToolTipML=ENU=Specifies the status of the document.;
                SourceExpr="Electronic Document Status";
                ImplicitType=Option }

    { 1020025;3;Field     ;
                Name="Date/Time Stamped";
                ToolTipML=ENU=Specifies the date and time that the document received a digital stamp from the authorized service provider.;
                SourceExpr="Date/Time Stamped";
                ImplicitType=Text50 }

    { 1020027;3;Field     ;
                Name="Date/Time Sent";
                ToolTipML=ENU=Specifies the date and time that the document was sent to the customer.;
                SourceExpr="Date/Time Sent";
                ImplicitType=Text50 }

    { 1020029;3;Field     ;
                Name="Date/Time Canceled";
                ToolTipML=ENU=Specifies the date and time that the document was canceled.;
                SourceExpr="Date/Time Canceled";
                ImplicitType=Text50 }

    { 1020031;3;Field     ;
                Name="Error Code";
                ToolTipML=ENU=Specifies the error code that the authorized service provider, PAC, has returned to Microsoft Dynamics NAV.;
                SourceExpr="Error Code";
                ImplicitType=Code10 }

    { 1020033;3;Field     ;
                Name="Error Description";
                ToolTipML=ENU=Specifies the error message that the authorized service provider, PAC, has returned to Microsoft Dynamics NAV.;
                SourceExpr="Error Description";
                ImplicitType=Text250 }

    { 1020035;3;Field     ;
                Name="PAC Web Service Name";
                ToolTipML=ENU=Specifies the name of the authorized service provider, PAC, which has processed the electronic document.;
                SourceExpr="PAC Web Service Name";
                Importance=Additional;
                ImplicitType=Text50 }

    { 1020037;3;Field     ;
                Name="Fiscal Invoice Number PAC";
                ToolTipML=ENU=Specifies the official invoice number for the electronic document.;
                SourceExpr="Fiscal Invoice Number PAC";
                Importance=Additional;
                ImplicitType=Text50 }

    { 1020021;3;Field     ;
                Name="No. of E-Documents Sent";
                ToolTipML=ENU=Specifies the number of times that this document has been sent electronically.;
                SourceExpr="No. of E-Documents Sent";
                ImplicitType=Integer }

    { 81  ;3   ;Field     ;
                Name="Package Tracking No.";
                ToolTipML=ENU=Specifies the shipping agent's package number.;
                ApplicationArea=#Suite;
                SourceExpr="Package Tracking No.";
                Importance=Additional;
                Editable=FALSE;
                ImplicitType=Text30 }

    { 1905885101;2;Group  ;
                Name="Ship-to";
                CaptionML=ENU=Ship-to;
                GroupType=Group }

    { 56  ;3   ;Field     ;
                Name="Ship-to Code";
                CaptionML=ENU=Address Code;
                ToolTipML=ENU=Specifies the address on purchase orders shipped with a drop shipment directly from the vendor to a customer.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Code";
                Importance=Promoted;
                Editable=FALSE;
                ImplicitType=Code10 }

    { 46  ;3   ;Field     ;
                Name="Ship-to Name";
                CaptionML=ENU=Name;
                ToolTipML=ENU=Specifies the name of the customer that the items were shipped to.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Name";
                Editable=FALSE;
                ImplicitType=Text50 }

    { 42  ;3   ;Field     ;
                Name="Ship-to Address";
                CaptionML=ENU=Address;
                ToolTipML=ENU=Specifies the address that the items on the invoice were shipped to.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Address";
                Editable=FALSE;
                ImplicitType=Text50 }

    { 44  ;3   ;Field     ;
                Name="Ship-to Address 2";
                CaptionML=ENU=Address 2;
                ToolTipML=ENU=Specifies additional address information.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Address 2";
                Editable=FALSE;
                ImplicitType=Text50 }

    { 40  ;3   ;Field     ;
                Name="Ship-to Post Code";
                CaptionML=ENU=ZIP Code;
                ToolTipML=ENU=Specifies the ZIP code.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Post Code";
                Editable=FALSE;
                ImplicitType=Code20 }

    { 38  ;3   ;Field     ;
                Name="Ship-to City";
                CaptionML=ENU=City;
                ToolTipML=ENU=Specifies the city of the customer on the sales document.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to City";
                Editable=FALSE;
                ImplicitType=Text30 }

    { 1020011;3;Field     ;
                Name="Ship-to County";
                CaptionML=ENU=State;
                ToolTipML=ENU=Specifies the state as a part of the address.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to County";
                Editable=FALSE;
                ImplicitType=Text30 }

    { 36  ;3   ;Field     ;
                Name="Ship-to Contact";
                CaptionML=ENU=Contact;
                ToolTipML=ENU=Specifies the name of the person you regularly contact at the address that the items were shipped to.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Contact";
                Editable=FALSE;
                ImplicitType=Text50 }

    { 1020013;3;Field     ;
                Name="Ship-to UPS Zone";
                CaptionML=ENU=UPS Zone;
                ToolTipML=ENU=Specifies the Ship-to UPS Zone of the customer to whom the invoice was sent.;
                SourceExpr="Ship-to UPS Zone";
                Editable=FALSE;
                ImplicitType=Code2 }

    { 60  ;2   ;Group     ;
                Name="Bill-to";
                CaptionML=ENU=Bill-to;
                GroupType=Group }

    { 18  ;3   ;Field     ;
                Name="Bill-to Name";
                CaptionML=ENU=Name;
                ToolTipML=ENU=Specifies the name of the customer that the invoice was sent to.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Bill-to Name";
                Importance=Promoted;
                Editable=FALSE;
                ImplicitType=Text50 }

    { 20  ;3   ;Field     ;
                Name="Bill-to Address";
                CaptionML=ENU=Address;
                ToolTipML=ENU=Specifies the address of the customer that the invoice was sent to.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Bill-to Address";
                Importance=Additional;
                Editable=FALSE;
                ImplicitType=Text50 }

    { 22  ;3   ;Field     ;
                Name="Bill-to Address 2";
                CaptionML=ENU=Address 2;
                ToolTipML=ENU=Specifies additional address information.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Bill-to Address 2";
                Importance=Additional;
                Editable=FALSE;
                ImplicitType=Text50 }

    { 24  ;3   ;Field     ;
                Name="Bill-to City";
                CaptionML=ENU=City;
                ToolTipML=ENU=Specifies the city of the customer on the sales document.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Bill-to City";
                Importance=Additional;
                Editable=FALSE;
                ImplicitType=Text30 }

    { 1020008;3;Field     ;
                Name="Bill-to County";
                CaptionML=ENU=State;
                ToolTipML=ENU=Specifies the state as a part of the address.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Bill-to County";
                Importance=Additional;
                Editable=FALSE;
                ImplicitType=Text30 }

    { 78  ;3   ;Field     ;
                Name="Bill-to Post Code";
                CaptionML=ENU=ZIP Code;
                ToolTipML=ENU=Specifies the ZIP code.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Bill-to Post Code";
                Importance=Additional;
                Editable=FALSE;
                ImplicitType=Code20 }

    { 98  ;3   ;Field     ;
                Name="Bill-to Contact No.";
                CaptionML=ENU=Contact No.;
                ToolTipML=ENU=Specifies the number of the contact the invoice was sent to.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Bill-to Contact No.";
                Importance=Additional;
                Editable=FALSE;
                ImplicitType=Code20 }

    { 26  ;3   ;Field     ;
                Name="Bill-to Contact";
                CaptionML=ENU=Contact;
                ToolTipML=ENU=Specifies the name of the person you regularly contact when you communicate with the customer to whom the invoice was sent.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Bill-to Contact";
                Editable=FALSE;
                ImplicitType=Text50 }

    { 1907468901;1;Group  ;
                Name="Foreign Trade";
                CaptionML=ENU=Foreign Trade }

    { 31  ;2   ;Field     ;
                Name="Transaction Specification";
                ToolTipML=ENU=Specifies the transaction specification that was used in the invoice.;
                ApplicationArea=#Advanced;
                SourceExpr="Transaction Specification";
                Editable=FALSE;
                ImplicitType=Code10 }

    { 72  ;2   ;Field     ;
                Name="Transport Method";
                ToolTipML=ENU=Specifies the transport method of the sales header that this line was posted from.;
                ApplicationArea=#Advanced;
                SourceExpr="Transport Method";
                Editable=FALSE;
                ImplicitType=Code10 }

    { 74  ;2   ;Field     ;
                Name="Exit Point";
                ToolTipML=ENU=Specifies the point of exit through which you ship the items out of your country/region, for reporting to Intrastat.;
                ApplicationArea=#Advanced;
                SourceExpr="Exit Point";
                Editable=FALSE;
                ImplicitType=Code10 }

    { 75  ;2   ;Field     ;
                Name=Area;
                ToolTipML=ENU=Specifies the area code used in the invoice.;
                ApplicationArea=#Advanced;
                SourceExpr=Area;
                Editable=FALSE;
                ImplicitType=Code10 }

    { 1900000007;0;Container;
                Name=Control1900000007;
                ContainerType=FactBoxArea }

    { 1901275107;1;Part   ;
                Name=Attached Documents;
                CaptionML=ENU=Attachments;
                ApplicationArea=#All;
                SubPageLink="Table ID"=CONST(112),
                            "No."=FIELD("No.");
                PagePartID="Document Attachment Factbox";
                PartType=Page }

    { 11  ;1   ;Part      ;
                Name=IncomingDocAttachFactBox;
                ApplicationArea=#Advanced;
                PagePartID="Incoming Doc. Attach. FactBox";
                Visible=FALSE;
                PartType=Page;
                ShowFilter=false }

    { 1900383207;1;Part   ;
                Name=Control1900383207;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Name=Control1905767507;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      SalesInvHeader@1000 : Record "Sales Invoice Header";
      ApplicationAreaMgmtFacade@1010 : Codeunit "Application Area Mgmt. Facade";
      CRMIntegrationManagement@1012 : Codeunit "CRM Integration Management";
      ChangeExchangeRate@1001 : Page "Change Exchange Rate";
      HasIncomingDocument@1002 : Boolean;
      DocExchStatusStyle@1003 : Text;
      CRMIntegrationEnabled@1004 : Boolean;
      CRMIsCoupledToRecord@1005 : Boolean;
      PaymentServiceVisible@1007 : Boolean;
      PaymentServiceEnabled@1008 : Boolean;
      DocExcStatusVisible@1006 : Boolean;
      IsOfficeAddin@1009 : Boolean;
      IsFoundationEnabled@1011 : Boolean;

    LOCAL PROCEDURE UpdatePaymentService@7();
    VAR
      PaymentServiceSetup@1000 : Record "Payment Service Setup";
    BEGIN
      PaymentServiceVisible := PaymentServiceSetup.IsPaymentServiceVisible;
      PaymentServiceEnabled := PaymentServiceSetup.CanChangePaymentService(Rec);
    END;

    [Integration]
    [External]
    LOCAL PROCEDURE OnBeforeCalculateSalesTaxStatistics@1020000(VAR SalesInvoiceHeader@1000 : Record "Sales Invoice Header");
    BEGIN
    END;

    BEGIN
    END.
  }
}

